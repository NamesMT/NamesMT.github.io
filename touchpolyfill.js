var DragDropTouch;!function(t){"use strict";var e=(Object.defineProperty(s.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(t){this._dropEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(t){this._effectAllowed=t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),s.prototype.clearData=function(t){null!=t?delete this._data[t]:this._data=null},s.prototype.getData=function(t){return this._data[t]||""},s.prototype.setData=function(t,e){this._data[t]=e},s.prototype.setDragImage=function(t,e,s){var o=i._instance;o._imgCustom=t,o._imgOffset={x:e,y:s}},s);function s(){this._dropEffect="move",this._effectAllowed="all",this._data={}}t.DataTransfer=e;var i=(o.getInstance=function(){return o._instance},o.prototype._touchstart=function(t){var e=this;if(this._shouldHandle(t)){if(Date.now()-this._lastClick<o._DBLCLICK&&this._dispatchEvent(t,"dblclick",t.target))return t.preventDefault(),void this._reset();this._reset();var s=this._closestDraggable(t.target);s&&(this._dispatchEvent(t,"mousemove",t.target)||this._dispatchEvent(t,"mousedown",t.target)||(this._dragSource=s,this._ptDown=this._getPoint(t),(this._lastTouch=t).preventDefault(),setTimeout(function(){e._dragSource==s&&null==e._img&&e._dispatchEvent(t,"contextmenu",s)&&e._reset()},o._CTXMENU),o._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout(function(){e._isDragEnabled=!0,e._touchmove(t)},o._PRESSHOLDAWAIT))))}},o.prototype._touchmove=function(t){var e;this._shouldCancelPressHoldMove(t)?this._reset():(this._shouldHandleMove(t)||this._shouldHandlePressHoldMove(t))&&(e=this._getTarget(t),this._dispatchEvent(t,"mousemove",e)?(this._lastTouch=t).preventDefault():(this._dragSource&&!this._img&&this._shouldStartDragging(t)&&(this._dispatchEvent(t,"dragstart",this._dragSource),this._createImage(t),this._dispatchEvent(t,"dragenter",e)),this._img&&((this._lastTouch=t).preventDefault(),e!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(t,"dragenter",e),this._lastTarget=e),this._moveImage(t),this._isDropZone=this._dispatchEvent(t,"dragover",e))))},o.prototype._touchend=function(t){this._shouldHandle(t)&&(this._dispatchEvent(this._lastTouch,"mouseup",t.target)?t.preventDefault():(this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",t.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(t.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())))},o.prototype._shouldHandle=function(t){return t&&!t.defaultPrevented&&t.touches&&t.touches.length<2},o.prototype._shouldHandleMove=function(t){return!o._ISPRESSHOLDMODE&&this._shouldHandle(t)},o.prototype._shouldHandlePressHoldMove=function(t){return o._ISPRESSHOLDMODE&&this._isDragEnabled&&t&&t.touches&&t.touches.length},o.prototype._shouldCancelPressHoldMove=function(t){return o._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(t)>o._PRESSHOLDMARGIN},o.prototype._shouldStartDragging=function(t){return t=this._getDelta(t),o._THRESHOLD<t||o._ISPRESSHOLDMODE&&o._PRESSHOLDTHRESHOLD<=t},o.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new e,clearInterval(this._pressHoldInterval)},o.prototype._getPoint=function(t,e){return t&&t.touches&&(t=t.touches[0]),{x:e?t.pageX:t.clientX,y:e?t.pageY:t.clientY}},o.prototype._getDelta=function(t){return o._ISPRESSHOLDMODE&&!this._ptDown?0:(t=this._getPoint(t),Math.abs(t.x-this._ptDown.x)+Math.abs(t.y-this._ptDown.y))},o.prototype._getTarget=function(t){t=this._getPoint(t);for(var e=document.elementFromPoint(t.x,t.y);e&&"none"==getComputedStyle(e).pointerEvents;)e=e.parentElement;return e},o.prototype._createImage=function(t){this._img&&this._destroyImage();var e,s=this._imgCustom||this._dragSource;this._img=s.cloneNode(!0),this._copyStyle(s,this._img),this._img.style.top=this._img.style.left="-9999px",this._imgCustom||(e=s.getBoundingClientRect(),s=this._getPoint(t),this._imgOffset={x:s.x-e.left,y:s.y-e.top},this._img.style.opacity=o._OPACITY.toString()),this._moveImage(t),document.body.appendChild(this._img)},o.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},o.prototype._moveImage=function(t){var e=this;requestAnimationFrame(function(){var s,i;e._img&&(s=e._getPoint(t,!0),(i=e._img.style).position="absolute",i.pointerEvents="none",i.zIndex="999999",i.left=Math.round(s.x-e._imgOffset.x)+"px",i.top=Math.round(s.y-e._imgOffset.y)+"px")})},o.prototype._copyProps=function(t,e,s){for(var i=0;i<s.length;i++){var o=s[i];t[o]=e[o]}},o.prototype._copyStyle=function(t,e){var s,i;o._rmvAtts.forEach(function(t){e.removeAttribute(t)}),t instanceof HTMLCanvasElement&&(s=t,(i=e).width=s.width,i.height=s.height,i.getContext("2d").drawImage(s,0,0));for(var n=getComputedStyle(t),r=0;r<n.length;r++){var a=n[r];a.indexOf("transition")<0&&(e.style[a]=n[a])}for(e.style.pointerEvents="none",r=0;r<t.children.length;r++)this._copyStyle(t.children[r],e.children[r])},o.prototype._dispatchEvent=function(t,e,s){if(t&&s){var i=document.createEvent("Event"),n=t.touches?t.touches[0]:t;return i.initEvent(e,!0,!0),i.button=0,i.which=i.buttons=1,this._copyProps(i,t,o._kbdProps),this._copyProps(i,n,o._ptProps),i.dataTransfer=this._dataTransfer,s.dispatchEvent(i),i.defaultPrevented}return!1},o.prototype._closestDraggable=function(t){for(;t;t=t.parentElement)if(t.hasAttribute("draggable")&&t.draggable)return t;return null},o);function o(){if(this._lastClick=0,o._instance)throw"DragDropTouch instance already created.";var t,e,s,i,n,r=!1;document.addEventListener("test",function(){},{get passive(){return r=!0}}),"ontouchstart"in document&&(t=document,e=this._touchstart.bind(this),s=this._touchmove.bind(this),i=this._touchend.bind(this),n=!!r&&{passive:!1,capture:!1},t.addEventListener("touchstart",e,n),t.addEventListener("touchmove",s,n),t.addEventListener("touchend",i),t.addEventListener("touchcancel",i))}i._instance=new i,i._THRESHOLD=5,i._OPACITY=.5,i._DBLCLICK=500,i._CTXMENU=900,i._ISPRESSHOLDMODE=!1,i._PRESSHOLDAWAIT=400,i._PRESSHOLDMARGIN=25,i._PRESSHOLDTHRESHOLD=0,i._rmvAtts="id,class,style,draggable".split(","),i._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),i._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),t.DragDropTouch=i}(DragDropTouch=DragDropTouch||{});